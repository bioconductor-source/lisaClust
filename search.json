[{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"","code":"if (!require(\"BiocManager\")) {   install.packages(\"BiocManager\") } BiocManager::install(\"lisaClust\") # load required packages library(lisaClust) library(spicyR) library(ggplot2) library(SingleCellExperiment) library(SpatialDatasets)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"Clustering local indicators spatial association (LISA) functions methodology identifying consistent spatial organisation multiple cell-types unsupervised way. can used enable characterization interactions multiple cell-types simultaneously can complement traditional pairwise analysis. implementation LISA curves localised summary L-function Poisson point process model. framework lisaClust can used provide high-level summary cell-type colocalization high-parameter spatial cytometry data, facilitating identification distinct tissue compartments identification complex cellular microenvironments.","code":""},{"path":[]},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-toy-data","dir":"Articles","previous_headings":"Quick start","what":"Generate toy data","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"illustrate lisaClust framework, consider simple toy example two cell-types completely separated spatially. simulate data two different images.","code":"set.seed(51773) x <- round(c(   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,   runif(200) + 3, runif(200) + 2, runif(200) + 1, runif(200) ), 4) * 100 y <- round(c(   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3 ), 4) * 100 cellType <- factor(paste(\"c\", rep(rep(c(1:2), rep(200, 2)), 4), sep = \"\")) imageID <- rep(c(\"s1\", \"s2\"), c(800, 800))  cells <- data.frame(x, y, cellType, imageID)  ggplot(cells, aes(x, y, colour = cellType)) +   geom_point() +   facet_wrap(~imageID) +   theme_minimal()"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"create-single-cell-experiment-object","dir":"Articles","previous_headings":"Quick start","what":"Create Single Cell Experiment object","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"First store data SingleCellExperiment object.","code":"SCE <- SingleCellExperiment(colData = cells) SCE ## class: SingleCellExperiment  ## dim: 0 1600  ## metadata(0): ## assays(0): ## rownames: NULL ## rowData names(0): ## colnames: NULL ## colData names(4): x y cellType imageID ## reducedDimNames(0): ## mainExpName: NULL ## altExpNames(0):"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"running-lisaclust","dir":"Articles","previous_headings":"Quick start","what":"Running lisaCLust","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"can use convenience function lisaClust simultaneously calculate local indicators spatial association (LISA) functions using lisa function perform k-means clustering. number clusters can specified k = parameter. example , ’ve chosen k = 2, resulting total 2 clusters. clusters stored colData SingleCellExperiment object, new column column name regions.","code":"SCE <- lisaClust(SCE, k = 2) colData(SCE) |> head() ## DataFrame with 6 rows and 5 columns ##           x         y cellType     imageID      region ##   <numeric> <numeric> <factor> <character> <character> ## 1     36.72     38.58       c1          s1    region_2 ## 2     61.38     41.29       c1          s1    region_2 ## 3     33.59     80.98       c1          s1    region_2 ## 4     50.17     64.91       c1          s1    region_2 ## 5     82.93     35.60       c1          s1    region_2 ## 6     83.13      2.69       c1          s1    region_2"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"plot-identified-regions","dir":"Articles","previous_headings":"Quick start","what":"Plot identified regions","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"lisaClust also provides convenient hatchingPlot function visualise different regions demarcated clustering. hatchingPlot outputs ggplot object regions marked different hatching patterns. real biological dataset, allows us plot regions cell-types visualization. example , can visualise stimulated data 2 cell types separated neatly 2 distinct regions based cell type region dominated . region_2 dominated red cell type c1, region_1 dominated blue cell type c2. ## Using clustering methods. lisaClust function convenient, implemented exhaustive suite clustering methods easy . just two simple steps.","code":"hatchingPlot(SCE, useImages = c(\"s1\", \"s2\"))"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-lisa-curves","dir":"Articles","previous_headings":"Quick start > Plot identified regions","what":"Generate LISA curves","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"can calculate local indicators spatial association (LISA) functions using lisa function. LISA curves localised summary L-function Poisson point process model. radii calculated can set Rs.","code":"lisaCurves <- lisa(SCE, Rs = c(20, 50, 100))"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"perform-some-clustering","dir":"Articles","previous_headings":"Quick start > Plot identified regions","what":"Perform some clustering","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"LISA curves can used cluster cells. use k-means clustering, clustering methods like SOM used. can store cell clusters cell “regions” SingleCellExperiment object.","code":"# Custom clustering algorithm kM <- kmeans(lisaCurves, 2)  # Storing clusters into colData colData(SCE)$custom_region <- paste(\"region\", kM$cluster, sep = \"_\") colData(SCE) |> head() ## DataFrame with 6 rows and 6 columns ##           x         y cellType     imageID      region custom_region ##   <numeric> <numeric> <factor> <character> <character>   <character> ## 1     36.72     38.58       c1          s1    region_2      region_2 ## 2     61.38     41.29       c1          s1    region_2      region_2 ## 3     33.59     80.98       c1          s1    region_2      region_2 ## 4     50.17     64.91       c1          s1    region_2      region_2 ## 5     82.93     35.60       c1          s1    region_2      region_2 ## 6     83.13      2.69       c1          s1    region_2      region_2"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"keren-et-al--breast-cancer-data-","dir":"Articles","previous_headings":"","what":"Keren et al. breast cancer data.","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"Next, apply lisaClust framework two images breast cancer Structured Tumor-Immune Microenvironment Triple Negative Breast Cancer Revealed Multiplexed Ion Beam Imaging Keren et al. (2018)","code":""},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"read-in-data","dir":"Articles","previous_headings":"Keren et al. breast cancer data.","what":"Read in data","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"start reading data SpatialDatasets package SingleCellExperiment object. data format consistent outputted CellProfiler.","code":"kerenSPE <- SpatialDatasets::spe_Keren_2018()"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"generate-lisa-curves-1","dir":"Articles","previous_headings":"Keren et al. breast cancer data.","what":"Generate LISA curves","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"data includes annotation cell-types cell. Hence, can move directly performing k-means clustering local indicators spatial association (LISA) functions using lisaClust function, remembering specify imageID, cellType, spatialCoords columns colData. purpose demonstration, using images 5 & 6 kerenSPE dataset. regions stored colData can extracted.","code":"kerenSPE <- kerenSPE[,kerenSPE$imageID %in% c(\"5\", \"6\")]  kerenSPE <- lisaClust(kerenSPE,   k = 5 ) colData(kerenSPE)[, c(\"imageID\", \"region\")] |>   head(20) ## DataFrame with 20 rows and 2 columns ##           imageID      region ##       <character> <character> ## 21154           5    region_4 ## 21155           5    region_4 ## 21156           5    region_4 ## 21157           5    region_3 ## 21158           5    region_3 ## ...           ...         ... ## 21169           5    region_3 ## 21170           5    region_3 ## 21171           5    region_1 ## 21172           5    region_3 ## 21173           5    region_1"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"examine-cell-type-enrichment","dir":"Articles","previous_headings":"Keren et al. breast cancer data.","what":"Examine cell type enrichment","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"lisaClust also provides convenient function, regionMap, examining cell types located regions. example, use check cell types appear frequently region expected chance. , clearly see healthy epithelial mesenchymal tissue highly concentrated region 1, immune cells concentrated regions 2 4, whilst tumour cells spread across regions 3 5. can segregate cells increasing number clusters, ie. increasing parameter k = lisaClust() function, purposes demonstration, let’s take look hatchingPlot regions.","code":"regionMap(kerenSPE,   type = \"bubble\" )"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"plot-identified-regions-1","dir":"Articles","previous_headings":"Keren et al. breast cancer data.","what":"Plot identified regions","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"Finally, can use hatchingPlot construct ggplot object regions marked different hatching patterns. allows us visualize 5 regions 17 cell-types simultaneously.","code":"hatchingPlot(kerenSPE)"},{"path":"https://github.com/ellispatrick/lisaClust/articles/lisaClust.html","id":"sessioninfo","dir":"Articles","previous_headings":"","what":"sessionInfo()","title":"Introduction to Clustering of Local Indicators of Spatial Assocation (LISA) curves","text":"","code":"sessionInfo() ## R version 4.4.1 (2024-06-14) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 22.04.4 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats4    stats     graphics  grDevices utils     datasets  methods   ## [8] base      ##  ## other attached packages: ##  [1] SpatialDatasets_1.2.0       SpatialExperiment_1.14.0    ##  [3] ExperimentHub_2.12.0        AnnotationHub_3.12.0        ##  [5] BiocFileCache_2.12.0        dbplyr_2.5.0                ##  [7] SingleCellExperiment_1.26.0 SummarizedExperiment_1.34.0 ##  [9] Biobase_2.64.0              GenomicRanges_1.56.1        ## [11] GenomeInfoDb_1.40.1         IRanges_2.38.1              ## [13] S4Vectors_0.42.1            BiocGenerics_0.50.0         ## [15] MatrixGenerics_1.16.0       matrixStats_1.3.0           ## [17] ggplot2_3.5.1               spicyR_1.16.3               ## [19] lisaClust_1.13.3            BiocStyle_2.32.1            ##  ## loaded via a namespace (and not attached): ##   [1] RColorBrewer_1.1-3          jsonlite_1.8.8              ##   [3] MultiAssayExperiment_1.30.3 magrittr_2.0.3              ##   [5] spatstat.utils_3.1-0        magick_2.8.4                ##   [7] farver_2.1.2                nloptr_2.1.1                ##   [9] rmarkdown_2.28              fs_1.6.4                    ##  [11] zlibbioc_1.50.0             ragg_1.3.2                  ##  [13] vctrs_0.6.5                 memoise_2.0.1               ##  [15] minqa_1.2.8                 spatstat.explore_3.3-1      ##  [17] rstatix_0.7.2               htmltools_0.5.8.1           ##  [19] S4Arrays_1.4.1              curl_5.2.1                  ##  [21] broom_1.0.6                 SparseArray_1.4.8           ##  [23] sass_0.4.9                  bslib_0.8.0                 ##  [25] desc_1.4.3                  plyr_1.8.9                  ##  [27] cachem_1.1.0                mime_0.12                   ##  [29] lifecycle_1.0.4             pkgconfig_2.0.3             ##  [31] Matrix_1.7-0                R6_2.5.1                    ##  [33] fastmap_1.2.0               GenomeInfoDbData_1.2.12     ##  [35] digest_0.6.36               numDeriv_2016.8-1.1         ##  [37] colorspace_2.1-1            AnnotationDbi_1.66.0        ##  [39] tensor_1.5                  RSQLite_2.3.7               ##  [41] textshaping_0.4.0           ggpubr_0.6.0                ##  [43] labeling_0.4.3              filelock_1.0.3              ##  [45] fansi_1.0.6                 spatstat.sparse_3.1-0       ##  [47] httr_1.4.7                  polyclip_1.10-7             ##  [49] abind_1.4-5                 mgcv_1.9-1                  ##  [51] compiler_4.4.1              bit64_4.0.5                 ##  [53] withr_3.0.1                 backports_1.5.0             ##  [55] BiocParallel_1.38.0         carData_3.0-5               ##  [57] DBI_1.2.3                   highr_0.11                  ##  [59] ggupset_0.4.0               ggforce_0.4.2               ##  [61] ggsignif_0.6.4              MASS_7.3-60.2               ##  [63] concaveman_1.1.0            rappdirs_0.3.3              ##  [65] DelayedArray_0.30.1         rjson_0.2.21                ##  [67] tools_4.4.1                 goftest_1.2-3               ##  [69] glue_1.7.0                  nlme_3.1-164                ##  [71] grid_4.4.1                  ClassifyR_3.8.3             ##  [73] reshape2_1.4.4              generics_0.1.3              ##  [75] gtable_0.3.5                spatstat.data_3.1-2         ##  [77] class_7.3-22                tidyr_1.3.1                 ##  [79] data.table_1.15.4           car_3.1-2                   ##  [81] utf8_1.2.4                  XVector_0.44.0              ##  [83] spatstat.geom_3.3-2         BiocVersion_3.19.1          ##  [85] pillar_1.9.0                stringr_1.5.1               ##  [87] splines_4.4.1               dplyr_1.1.4                 ##  [89] tweenr_2.0.3                lattice_0.22-6              ##  [91] bit_4.0.5                   survival_3.6-4              ##  [93] deldir_2.0-4                tidyselect_1.2.1            ##  [95] Biostrings_2.72.1           knitr_1.48                  ##  [97] V8_5.0.0                    bookdown_0.40               ##  [99] xfun_0.47                   pheatmap_1.0.12             ## [101] scam_1.2-17                 stringi_1.8.4               ## [103] UCSC.utils_1.0.0            yaml_2.3.10                 ## [105] boot_1.3-30                 evaluate_0.24.0             ## [107] codetools_0.2-20            tibble_3.2.1                ## [109] BiocManager_1.30.23         cli_3.6.3                   ## [111] systemfonts_1.1.0           munsell_0.5.1               ## [113] jquerylib_0.1.4             Rcpp_1.0.13                 ## [115] spatstat.random_3.3-1       png_0.1-8                   ## [117] spatstat.univar_3.0-0       parallel_4.4.1              ## [119] blob_1.2.4                  pkgdown_2.1.0               ## [121] lme4_1.1-35.5               lmerTest_3.1-3              ## [123] scales_1.3.0                purrr_1.0.2                 ## [125] crayon_1.5.3                rlang_1.1.4                 ## [127] KEGGREST_1.44.1"},{"path":"https://github.com/ellispatrick/lisaClust/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ellis Patrick. Author, maintainer. Nicolas Canete. Author. Nicholas Robertson. Contributor.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Patrick E, Canete N (2024). lisaClust: lisaClust: Clustering Local Indicators Spatial Association. R package version 1.13.3, https://github.com/ellispatrick/lisaClust, https://ellispatrick.github.io/lisaClust/.","code":"@Manual{,   title = {lisaClust: lisaClust: Clustering of Local Indicators of Spatial Association},   author = {Ellis Patrick and Nicolas Canete},   year = {2024},   note = {R package version 1.13.3, https://github.com/ellispatrick/lisaClust},   url = {https://ellispatrick.github.io/lisaClust/}, }"},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"lisaclust","dir":"","previous_headings":"","what":"lisaClust: Clustering of Local Indicators of Spatial Association","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Clustering Local Indicators Spatial Association","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"lisaClust provides series functions identify visualise regions tissue spatial associations cell-types similar. package can used provide high-level summary cell-type colocalisation multiplexed imaging data segmented single-cell resolution.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Bioconductor release version, run following. like --date features, install recent development version.","code":"if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  BiocManager::install(\"lisaClust\") # Install the development version from Bioconductor: if (!require(\"BiocManager\", quietly = TRUE))     install.packages(\"BiocManager\")  # The following initializes usage of Bioc devel # This will update all your Bioconductor packages to devel version BiocManager::install(version='devel')  BiocManager::install(\"lisaClust\")  # Otherwise install the development version from GitHub: # install.packages(\"devtools\") devtools::install_github(\"ellispatrick/lisaClust\") library(lisaClust)"},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"submitting-an-issue-or-feature-request","dir":"","previous_headings":"","what":"Submitting an issue or feature request","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"listClust still active development. greatly appreciate feedback related package. R package related issues raised . general questions feedback, please contact us directly via ellis.patrick@sydney.edu.au.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"authors","dir":"","previous_headings":"","what":"Authors","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Nicolas Canete Ellis Patrick - @TheEllisPatrick","code":""},{"path":"https://github.com/ellispatrick/lisaClust/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"lisaClust: Clustering of Local Indicators of Spatial Association","text":"Patrick, E, Canete, NP, Iyengar, SS, Harman, , Sutherland, GT, Yang, P. Spatial analysis highly multiplexed imaging data identify tissue microenvironments. Cytometry. 2023. https://doi.org/10.1002/cyto..24729","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"hatchingPlot — hatchingPlot","title":"hatchingPlot — hatchingPlot","text":"hatchingPlot() function used create hatching patterns representating spatial regions cell-types. hatching geom used create hatching patterns representation spatial regions.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"hatchingPlot — hatchingPlot","text":"","code":"hatchingPlot(   data,   useImages = NULL,   region = \"region\",   imageID = \"imageID\",   cellType = \"cellType\",   spatialCoords = c(\"x\", \"y\"),   window = \"concave\",   line.spacing = 21,   hatching.colour = 1,   nbp = 50,   window.length = NULL )  geom_hatching(   mapping = NULL,   data = NULL,   stat = \"identity\",   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   line.spacing = 21,   hatching.colour = 1,   window = \"concave\",   window.length = NULL,   nbp = 250,   line.width = 1,   ... )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"hatchingPlot — hatchingPlot","text":"data data displayed layer. three options: NULL, default, data inherited plot data specified call ggplot(). data.frame, object, override plot data. objects fortified produce data frame. See fortify()  variables created. function called single argument,  plot data. return value must data.frame, used  layer data. function can created formula (e.g. ~ head(.x, 10)). useImages vector images plot. region region column plot. imageID imageIDs column using data.frame SingleCellExperiment. cellType cellType column using data.frame SingleCellExperiment. spatialCoords spatial coordinates columns using data.frame SingleCellExperiment. window window around regions 'square', 'convex' 'concave'. line.spacing integer indicating spacing hatching lines. hatching.colour colour hatching. nbp integer tuning granularity grid used defining regions window.length tuning parameter controlling level concavity estimating concave windows. mapping Set aesthetic mappings created aes() aes_(). specified inherit.aes = TRUE (default), combined default mapping top level plot. must supply mapping plot mapping. stat statistical transformation use data layer string. position adjustment, either string, result call position adjustment function. na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. FALSE never includes, TRUE always includes. can also named logical vector finely select aesthetics display. inherit.aes FALSE, overrides default aesthetics, rather combining . useful helper functions define data aesthetics inherit behaviour default plot specification, e.g. borders(). line.width numeric controlling width hatching lines ... arguments passed layer(). often aesthetics, used set aesthetic fixed value, like colour = \"red\" size = 3. may also parameters paired geom/stat.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"hatchingPlot — hatchingPlot","text":"ggplot object ggplot geom","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/hatchingPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"hatchingPlot — hatchingPlot","text":"","code":"## Generate toy data set.seed(51773) x <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200) + 3, runif(200) + 2, runif(200) + 1, runif(200) ), 4) * 100 y <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3 ), 4) * 100 cellType <- factor(paste(\"c\", rep(rep(c(1:2), rep(200, 2)), 4), sep = \"\")) imageID <- rep(c(\"s1\", \"s2\"), c(800, 800)) cells <- data.frame(x, y, cellType, imageID) cells <- SingleCellExperiment::SingleCellExperiment(colData = cells)  ## Generate regions cells <- lisaClust(cells, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  ## Plot regions hatchingPlot(cells) #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems.   ## Generate toy data set.seed(51773) library(ggplot2) x <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200) + 3, runif(200) + 2, runif(200) + 1, runif(200) ), 4) * 100 y <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3 ), 4) * 100 cellType <- factor(paste(\"c\", rep(rep(c(1:2), rep(200, 2)), 4), sep = \"\")) imageID <- rep(c(\"s1\", \"s2\"), c(800, 800)) cells <- data.frame(x, y, cellType, imageID) ## Generate regions cells <- lisaClust(cells, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  # Plot the regions with geom_hatching() ggplot(     cells, aes(x = x, y = y, colour = cellType, region = region) ) +     geom_point() +     facet_wrap(~imageID) +     geom_hatching() #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems. #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems."},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate the inhomogenous local K function. — inhomLocalK","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"Calculate inhomogenous local K function.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"","code":"inhomLocalK(   data,   Rs = c(20, 50, 100, 200),   sigma = 10000,   window = \"convex\",   window.length = NULL,   minLambda = 0.05,   lisaFunc = \"K\" )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"data data. Rs vector radii measures association calculated. sigma numeric variable used scaling filting inhomogeneous L-curves. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity. minLambda Minimum value density scaling fitting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/inhomLocalK.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate the inhomogenous local K function. — inhomLocalK","text":"","code":"library(spicyR) # Read in data isletFile <- system.file(\"extdata\", \"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header = TRUE) cells$x <- cells$AreaShape_Center_X cells$y <- cells$AreaShape_Center_Y cells$cellType <- as.factor(sample(   c(\"big\", \"medium\", \"small\"),   length(cells$AreaShape_Center_Y),   replace = TRUE )) cells$cellID <- as.factor(cells$ObjectNumber)  inhom <- inhomLocalK(cells[1:100, ])"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate local indicators of spatial association — lisa","title":"Generate local indicators of spatial association — lisa","text":"Generate local indicators spatial association","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate local indicators of spatial association — lisa","text":"","code":"lisa(   cells,   Rs = NULL,   BPPARAM = BiocParallel::SerialParam(),   window = \"convex\",   window.length = NULL,   whichParallel = \"imageID\",   sigma = NULL,   lisaFunc = \"K\",   minLambda = 0.05,   fast = TRUE,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\" )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate local indicators of spatial association — lisa","text":"cells SingleCellExperiment, SpatialExperiment data frame contains least variables x y, giving  coordinates cell, imageID cellType. Rs vector radii measures association calculated. BPPARAM BiocParallelParam object. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity estimating concave windows. whichParallel function use parallization imageID cellType. sigma numeric variable used scaling filting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve. minLambda Minimum value density scaling fitting inhomogeneous L-curves. fast logical describing whether use fast approximation inhomogeneous local L-curves. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate local indicators of spatial association — lisa","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate local indicators of spatial association — lisa","text":"","code":"library(spicyR) library(SingleCellExperiment) #> Loading required package: SummarizedExperiment #> Loading required package: MatrixGenerics #> Loading required package: matrixStats #>  #> Attaching package: ‘MatrixGenerics’ #> The following objects are masked from ‘package:matrixStats’: #>  #>     colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse, #>     colCounts, colCummaxs, colCummins, colCumprods, colCumsums, #>     colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs, #>     colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats, #>     colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds, #>     colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads, #>     colWeightedMeans, colWeightedMedians, colWeightedSds, #>     colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet, #>     rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods, #>     rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps, #>     rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins, #>     rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks, #>     rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars, #>     rowWeightedMads, rowWeightedMeans, rowWeightedMedians, #>     rowWeightedSds, rowWeightedVars #> Loading required package: GenomicRanges #> Loading required package: stats4 #> Loading required package: BiocGenerics #>  #> Attaching package: ‘BiocGenerics’ #> The following objects are masked from ‘package:stats’: #>  #>     IQR, mad, sd, var, xtabs #> The following objects are masked from ‘package:base’: #>  #>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append, #>     as.data.frame, basename, cbind, colnames, dirname, do.call, #>     duplicated, eval, evalq, get, grep, grepl, intersect, is.unsorted, #>     lapply, mapply, match, mget, order, paste, pmax, pmax.int, pmin, #>     pmin.int, rank, rbind, rownames, sapply, setdiff, table, tapply, #>     union, unique, unsplit, which.max, which.min #> Loading required package: S4Vectors #>  #> Attaching package: ‘S4Vectors’ #> The following object is masked from ‘package:utils’: #>  #>     findMatches #> The following objects are masked from ‘package:base’: #>  #>     I, expand.grid, unname #> Loading required package: IRanges #> Loading required package: GenomeInfoDb #> Loading required package: Biobase #> Welcome to Bioconductor #>  #>     Vignettes contain introductory material; view with #>     'browseVignettes()'. To cite Bioconductor, see #>     'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'. #>  #> Attaching package: ‘Biobase’ #> The following object is masked from ‘package:MatrixGenerics’: #>  #>     rowMedians #> The following objects are masked from ‘package:matrixStats’: #>  #>     anyMissing, rowMedians # Read in data isletFile <- system.file(\"extdata\", \"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header = TRUE) cellExp <- SingleCellExperiment(   assay = list(intensities = t(cells[, grepl(names(cells), pattern = \"Intensity_\")])),   colData = cells[, !grepl(names(cells), pattern = \"Intensity_\")] )  # Cluster cell types markers <- t(assay(cellExp, \"intensities\")) kM <- kmeans(markers, 8) colData(cellExp)$cluster <- paste(\"cluster\", kM$cluster, sep = \"\")  # Generate LISA lisaCurves <- lisa(   cellExp,   spatialCoords = c(\"Location_Center_X\", \"Location_Center_Y\"),   cellType = \"cluster\", imageID = \"ImageNumber\" ) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  # Cluster the LISA curves kM <- kmeans(lisaCurves, 2)"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":null,"dir":"Reference","previous_headings":"","what":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"Use k-means clustering cluster local indicators spatial association. clustering use lisa.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"","code":"lisaClust(   cells,   k = 2,   Rs = NULL,   spatialCoords = c(\"x\", \"y\"),   cellType = \"cellType\",   imageID = \"imageID\",   regionName = \"region\",   BPPARAM = BiocParallel::SerialParam(),   window = \"convex\",   window.length = NULL,   whichParallel = \"imageID\",   sigma = NULL,   lisaFunc = \"K\",   minLambda = 0.05,   fast = TRUE )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"cells SingleCellExperiment, SpatialExperiment data frame contains least variables x y, giving  coordinates cell, imageID cellType. k number regions cluster. Rs vector radii measures association calculated. spatialCoords columns contain x y spatial coordinates. cellType column contains cell types. imageID column contains image identifiers. regionName output column lisaClust regions. BPPARAM BiocParallelParam object. window window around regions 'square', 'convex' 'concave'. window.length tuning parameter controlling level concavity estimating concave windows. whichParallel function use parallization imageID cellType. sigma numeric variable used scaling filting inhomogeneous L-curves. lisaFunc Either \"K\" \"L\" curve. minLambda Minimum value density scaling fitting inhomogeneous L-curves. fast logical describing whether use fast approximation inhomogeneous local L-curves.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"matrix LISA curves","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/lisaClust.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Use k-means clustering to cluster local indicators of spatial association. For other clustering use lisa. — lisaClust","text":"","code":"library(spicyR) library(SingleCellExperiment) # Read in data isletFile <- system.file(\"extdata\", \"isletCells.txt.gz\", package = \"spicyR\") cells <- read.table(isletFile, header = TRUE) cellExp <- SingleCellExperiment(     assay = list(intensities = t(cells[, grepl(names(cells), pattern = \"Intensity_\")])),     colData = cells[, !grepl(names(cells), pattern = \"Intensity_\")] )  # Cluster cell types markers <- t(assay(cellExp, \"intensities\")) kM <- kmeans(markers, 8) colData(cellExp)$cluster <- paste(\"cluster\", kM$cluster, sep = \"\")  # Generate LISA cellExp <- lisaClust(cellExp,     k = 2,     imageID = \"ImageNumber\",     cellType = \"cluster\",     spatialCoords = c(\"Location_Center_X\", \"Location_Center_Y\") ) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'."},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"Plot heatmap cell type enrichment lisaClust regions","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"","code":"regionMap(   cells,   type = \"bubble\",   cellType = \"cellType\",   region = \"region\",   limit = c(0.33, 3),   ... )"},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"cells SingleCellExperiment, SpatialExperiment data.frame type Make \"bubble\" \"heatmap\" plot. cellType column storing cell types region column storing regions limit limits lower upper relative frequencies ... arguments passed pheatmap package","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"bubble plot heatmap","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/regionMap.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot heatmap of cell type enrichment for lisaClust regions — regionMap","text":"","code":"set.seed(51773) x <- round(c(   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,   runif(200) + 3, runif(200) + 2, runif(200) + 1, runif(200) ), 4) * 100 y <- round(c(   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,   runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3 ), 4) * 100 cellType <- factor(paste(\"c\", rep(rep(c(1:2), rep(200, 2)), 4), sep = \"\")) imageID <- rep(c(\"s1\", \"s2\"), c(800, 800))  cells <- data.frame(x, y, cellType, imageID)  cells <- lisaClust(cells, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  regionMap(cells)"},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":null,"dir":"Reference","previous_headings":"","what":"Scale constructor for regions — scale_region","title":"Scale constructor for regions — scale_region","text":"Region scale constructor.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Scale constructor for regions — scale_region","text":"","code":"scale_region(aesthetics = \"region\", ..., guide = \"legend\")  scale_region_manual(..., values)"},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Scale constructor for regions — scale_region","text":"aesthetics names aesthetics scale works ... Arguments passed discrete_scale guide function used create guide name. See guides() info. values set aesthetic values map data values . named vector, values matched based names. unnamed, values matched order (usually alphabetical) limits scale. data values match given na.value.","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Scale constructor for regions — scale_region","text":"ggplot guide","code":""},{"path":"https://github.com/ellispatrick/lisaClust/reference/scale_region.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Scale constructor for regions — scale_region","text":"","code":"library(spicyR) ## Generate toy data set.seed(51773) x <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200) + 3, runif(200) + 2, runif(200) + 1, runif(200) ), 4) * 100 y <- round(c(     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3,     runif(200), runif(200) + 1, runif(200) + 2, runif(200) + 3 ), 4) * 100 cellType <- factor(paste(\"c\", rep(rep(c(1:2), rep(200, 2)), 4), sep = \"\")) imageID <- rep(c(\"s1\", \"s2\"), c(800, 800)) cells <- data.frame(x, y, cellType, imageID) cells <- SingleCellExperiment::SingleCellExperiment(colData = cells)  ## Generate regions cells <- lisaClust(cells, k = 2) #> Generating local L-curves. If you run out of memory, try 'fast = FALSE'.  # Plot the regions with hatchingPlot() hatchingPlot(cells) +     scale_region_manual(         values = c(1, 4), labels = c(\"Region A\", \"Region B\"),         name = \"Regions\"     ) #> Scale for region is already present. #> Adding another scale for region, which will replace the existing scale. #> Concave windows are temperamental. Try choosing values of window.length > and < 1 if you have problems."}]
